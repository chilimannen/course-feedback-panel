<link rel="import" href="../bower_components/polymer/polymer.html">

<dom-module id="list-voting">
    <link rel="import" href="../style/melon.css" type="css">
    <link rel="import" href="../style/style.css" type="css">
    <template>
        <style>
            :host {
                display: inline-block;
            }

        </style>

        <div>
            <paper-material elevation="0">
                <p>
                <h6>
                    &copy;2016.
                </h6>
                </p>
            </paper-material>
        </div>

        <!-- Status toasts. -->
        <paper-toast class="toast-success" id="toast-success" text="Votings received from server."></paper-toast>
        <paper-toast class="toast-error" id="toast-server-denied" text="Failed to list votings."></paper-toast>

    </template>
    <script>
        Polymer({
            is: 'list-voting',

            ready: function () {
                var self = this;

                application.onAuthentication(function (authentication) {
                    console.log(authentication.token);

                    $.ajax({
                        type: "POST",
                        url: "/api/list",
                        dataType: "json",
                        contentType: "application/json; charset=utf-8",
                        data: JSON.stringify({token: authentication.token})
                        ,
                        success: function (data) {
                            console.log(data);

                            self.option = "";
                            self.name = "";
                            self.options = [];
                            self.$['toast-success'].open();
                        }

                        ,
                        error: function (data) {
                            console.log(data);

                            self.$['toast-server-denied'].open();
                            self.password = "";
                        }
                    });
                });
            }
        })
        ;
    </script>
</dom-module>